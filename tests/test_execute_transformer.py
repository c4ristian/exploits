"""
This module provides testcases for the script execute_transformer.py.
"""

import pytest
from execute_transformer import _strip_extension, _parse_exploit_file


def test_parse_exploit_file():
    """
    Testcase for the function _line_count.

    :return: None.
    """
    line_count, lang_guessed = _parse_exploit_file("tests/files/hello_world.py")
    assert line_count == 6
    assert lang_guessed == "Python"

    line_count, lang_guessed = _parse_exploit_file("tests/files/25807.txt")
    assert line_count == 5
    assert lang_guessed == "Text only"

    line_count, lang_guessed = _parse_exploit_file("tests/files/19046.txt")
    assert line_count == 15
    assert lang_guessed == "Text only"

    line_count, lang_guessed = _parse_exploit_file("tests/files/empty_file")
    assert line_count == 0
    assert lang_guessed is None

    with pytest.raises(FileNotFoundError):
        assert _parse_exploit_file("No_such_file")


def test_strip_extension():
    """
    Testcase for the function _strip_extension.

    :return: None.
    """
    assert _strip_extension(None) is None
    assert _strip_extension("") is None
    assert _strip_extension(".") == ""
    assert _strip_extension("test.py") == "py"
    assert _strip_extension("file.txt") == "txt"
    assert _strip_extension("weirdfile.txt.py") == "txt.py"
